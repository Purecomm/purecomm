// GLOBAL JS // 

// Navigation, Desktop & Mobile //
languageOptions = ['en', 'zh-cn', 'zh-hk', 'jp-jp', 'ko-kr', 'th-th'];
languageDictionary = {
    'en': 'en',
    'en-gb': 'en',
    'en-us': 'en',
    'zh-cn': 'zh-cn',
} // FILL IN THE REST OF THESE


function checkLanguage() {
    let lang = localStorage.getItem('lang');  
    if (!lang) {
        lang = navigator.language.toLocaleLowerCase();
    }
    if (lang) {
        let userLang = languageDictionary[lang];

        let urlLang = window.location.pathname.split('/')[1];

        if (languageOptions.indexOf(urlLang) !== -1 && urlLang !== userLang) {
            changeLanguage(userLang);
        }
    }
};

checkLanguage();


function changeLanguage(lang) {
    if (languageOptions.indexOf(lang) === -1) {
        return;
    }
    localStorage.setItem('lang', lang);
    window.location.href = '/' + lang;
}


var windowWidth = $(window).width();
if (windowWidth > 800) {
    $('.main-links').mouseenter(function (e) {
        $(".nav-dropdown").hide();
        $(this).next('.nav-dropdown').show();
        e.stopPropagation();
    });

    $('.nav-dropdown').mouseleave(function (e) {
        $('.nav-dropdown').hide();
        e.stopPropagation();
    });

    $('.nav-dropdown').click(function (e) {
        $('.nav-dropdown').hide();
        e.stopPropagation();
    });

    $('nav').mouseleave(function (e) {
        $('.nav-dropdown').hide();
    })
}

if (windowWidth < 800) {
    $('.main-links').click(function (e) {
        $(this).next('.nav-dropdown').slideToggle();
        e.preventDefault();
        e.stopPropagation();
    });
}

$('.nav-dropdown').click(function () {
    $('.nav-dropdown').hide();
});
$('html:not(.nav-dropdown)').click(function (e) {
    $('.nav-dropdown').hide();
    e.stopPropagation();
});

$('#nav-toggle').click(function () {
    $('nav ul').slideToggle();
});

$('#nav-toggle').on('click', function () {
    this.classList.toggle('active');
});
$('.nav-dropdown').click(function (e) {
    $('#nav-toggle').removeClass('active');
    $('.nav-list').hide();
    e.stopPropagation();
})
$('nav > ul > li > a:only-child').click(function (e) {
    $('#nav-toggle').removeClass('active');
    $('.nav-list').hide();
    e.stopPropagation();
});

$(document).ready(function () {
    var speed = 1500;

    var hash = window.location.hash;
    if ($(hash).length) scrollToID(hash, speed);
})

function scrollToID(id, speed) {
    var offSet = 10;
    var obj = $(id).offset();
    var targetOffset = obj.top - offSet;
    $('html, body').animate({ scrollTop: targetOffset }, speed);
}







// $(document).ready(function(){
//     var speed = 1000;

//     var hash = window.location.hash;
//     if ($(hash).length)scrollToID(hash,speed);
// })

// function scrollToID(id, speed) {
//     var offSet = 10;
//     var obj = $(id).offset();
//     var targetOffset = obj.top - offSet;
//     $('html, body').animate({ scrollTop: targetOffset}, speed);
// }

// $(document).ready(function(){
//     $("a").on('click', function(e){
//         if(this.hash !== "") {
//             e.preventDefault();

//             var hash = this.hash;

//             $('html, body').animate({
//                 scrollTop: $(hash).offset().top
//             }, 800, function(){
//                 window.location.hash = hash;
//             });
//         }
//     });
// });

$("a[href^='#']").click(function(e) {
	e.preventDefault();
	
	var position = $($(this).attr("href")).offset().top;

	$("body, html").animate({
		scrollTop: position
	}, 1500 );
});
 

var windowWidth = $(window).width();
if(windowWidth > 800) {
    $(function() {
        $("a[href*='#'][href!='#']").click(function() {
            $('.nav-dropdown').hide();
            if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
                var target = $(this.hash);
                target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
                if (target.length) {
                    $('html,body').animate({
                        scrollTop: target.offset().top
                    }, 1500);
                    return false;
                }
            }
        });
    });
}

if(windowWidth < 800) {
    $(function() {
        $("a[href*='#'][href!='#']").click(function() {
            $('nav ul').slideToggle();
            $('#nav-toggle').removeClass('active');
            $('.nav-list').hide();
            if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
                var target = $(this.hash);
                target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
                if (target.length) {
                    $('html,body').animate({
                        scrollTop: target.offset().top
                    }, 1500);
                    return false;
                }
            }
        });
    });
}